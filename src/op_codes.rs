// generate in elixir by: `1..183  |> Enum.map(fn index -> {func, arity} = :beam_opcodes.opname(index); "#{Macro.camelize(to_string(func))} = #{index}" end) |> Enum.join(",\n") |> IO.puts`
#[repr(u8)]
#[derive(Debug, PartialEq, Clone, Copy)]
pub enum OpCode {
    Label = 1,
    FuncInfo = 2,
    IntCodeEnd = 3,
    Call = 4,
    CallLast = 5,
    CallOnly = 6,
    CallExt = 7,
    CallExtLast = 8,
    Bif0 = 9,
    Bif1 = 10,
    Bif2 = 11,
    Allocate = 12,
    AllocateHeap = 13,
    AllocateZero = 14,
    AllocateHeapZero = 15,
    TestHeap = 16,
    Init = 17,
    Deallocate = 18,
    Return = 19,
    Send = 20,
    RemoveMessage = 21,
    Timeout = 22,
    LoopRec = 23,
    LoopRecEnd = 24,
    Wait = 25,
    WaitTimeout = 26,
    MPlus = 27,
    MMinus = 28,
    MTimes = 29,
    MDiv = 30,
    IntDiv = 31,
    IntRem = 32,
    IntBand = 33,
    IntBor = 34,
    IntBxor = 35,
    IntBsl = 36,
    IntBsr = 37,
    IntBnot = 38,
    IsLt = 39,
    IsGe = 40,
    IsEq = 41,
    IsNe = 42,
    IsEqExact = 43,
    IsNeExact = 44,
    IsInteger = 45,
    IsFloat = 46,
    IsNumber = 47,
    IsAtom = 48,
    IsPid = 49,
    IsReference = 50,
    IsPort = 51,
    IsNil = 52,
    IsBinary = 53,
    IsConstant = 54,
    IsList = 55,
    IsNonemptyList = 56,
    IsTuple = 57,
    TestArity = 58,
    SelectVal = 59,
    SelectTupleArity = 60,
    Jump = 61,
    Catch = 62,
    CatchEnd = 63,
    Move = 64,
    GetList = 65,
    GetTupleElement = 66,
    SetTupleElement = 67,
    PutString = 68,
    PutList = 69,
    PutTuple = 70,
    Put = 71,
    Badmatch = 72,
    IfEnd = 73,
    CaseEnd = 74,
    CallFun = 75,
    MakeFun = 76,
    IsFunction = 77,
    CallExtOnly = 78,
    BsStartMatch = 79,
    BsGetInteger = 80,
    BsGetFloat = 81,
    BsGetBinary = 82,
    BsSkipBits = 83,
    BsTestTail = 84,
    BsSave = 85,
    BsRestore = 86,
    BsInit = 87,
    BsFinal = 88,
    BsPutInteger = 89,
    BsPutBinary = 90,
    BsPutFloat = 91,
    BsPutString = 92,
    BsNeedBuf = 93,
    Fclearerror = 94,
    Fcheckerror = 95,
    Fmove = 96,
    Fconv = 97,
    Fadd = 98,
    Fsub = 99,
    Fmul = 100,
    Fdiv = 101,
    Fnegate = 102,
    MakeFun2 = 103,
    Try = 104,
    TryEnd = 105,
    TryCase = 106,
    TryCaseEnd = 107,
    Raise = 108,
    BsInit2 = 109,
    BsBitsToBytes = 110,
    BsAdd = 111,
    Apply = 112,
    ApplyLast = 113,
    IsBoolean = 114,
    IsFunction2 = 115,
    BsStartMatch2 = 116,
    BsGetInteger2 = 117,
    BsGetFloat2 = 118,
    BsGetBinary2 = 119,
    BsSkipBits2 = 120,
    BsTestTail2 = 121,
    BsSave2 = 122,
    BsRestore2 = 123,
    GcBif1 = 124,
    GcBif2 = 125,
    BsFinal2 = 126,
    BsBitsToBytes2 = 127,
    PutLiteral = 128,
    IsBitstr = 129,
    BsContextToBinary = 130,
    BsTestUnit = 131,
    BsMatchString = 132,
    BsInitWritable = 133,
    BsAppend = 134,
    BsPrivateAppend = 135,
    Trim = 136,
    BsInitBits = 137,
    BsGetUtf8 = 138,
    BsSkipUtf8 = 139,
    BsGetUtf16 = 140,
    BsSkipUtf16 = 141,
    BsGetUtf32 = 142,
    BsSkipUtf32 = 143,
    BsUtf8Size = 144,
    BsPutUtf8 = 145,
    BsUtf16Size = 146,
    BsPutUtf16 = 147,
    BsPutUtf32 = 148,
    OnLoad = 149,
    RecvMark = 150,
    RecvSet = 151,
    GcBif3 = 152,
    Line = 153,
    PutMapAssoc = 154,
    PutMapExact = 155,
    IsMap = 156,
    HasMapFields = 157,
    GetMapElements = 158,
    IsTaggedTuple = 159,
    BuildStacktrace = 160,
    RawRaise = 161,
    GetHd = 162,
    GetTl = 163,
    PutTuple2 = 164,
    BsGetTail = 165,
    BsStartMatch3 = 166,
    BsGetPosition = 167,
    BsSetPosition = 168,
    Swap = 169,
    BsStartMatch4 = 170,
    MakeFun3 = 171,
    InitYregs = 172,
    RecvMarkerBind = 173,
    RecvMarkerClear = 174,
    RecvMarkerReserve = 175,
    RecvMarkerUse = 176,
    BsCreateBin = 177,
    CallFun2 = 178,
    NifStart = 179,
    Badrecord = 180,
    UpdateRecord = 181,
    BsMatch = 182,
    ExecutableLine = 183,
}

impl TryFrom<u8> for OpCode {
    type Error = String;

    fn try_from(value: u8) -> Result<Self, Self::Error> {
        use OpCode::*;

        let op_code = match value {
            1 => Label,
            2 => FuncInfo,
            3 => IntCodeEnd,
            4 => Call,
            5 => CallLast,
            6 => CallOnly,
            7 => CallExt,
            8 => CallExtLast,
            9 => Bif0,
            10 => Bif1,
            11 => Bif2,
            12 => Allocate,
            13 => AllocateHeap,
            14 => AllocateZero,
            15 => AllocateHeapZero,
            16 => TestHeap,
            17 => Init,
            18 => Deallocate,
            19 => Return,
            20 => Send,
            21 => RemoveMessage,
            22 => Timeout,
            23 => LoopRec,
            24 => LoopRecEnd,
            25 => Wait,
            26 => WaitTimeout,
            27 => MPlus,
            28 => MMinus,
            29 => MTimes,
            30 => MDiv,
            31 => IntDiv,
            32 => IntRem,
            33 => IntBand,
            34 => IntBor,
            35 => IntBxor,
            36 => IntBsl,
            37 => IntBsr,
            38 => IntBnot,
            39 => IsLt,
            40 => IsGe,
            41 => IsEq,
            42 => IsNe,
            43 => IsEqExact,
            44 => IsNeExact,
            45 => IsInteger,
            46 => IsFloat,
            47 => IsNumber,
            48 => IsAtom,
            49 => IsPid,
            50 => IsReference,
            51 => IsPort,
            52 => IsNil,
            53 => IsBinary,
            54 => IsConstant,
            55 => IsList,
            56 => IsNonemptyList,
            57 => IsTuple,
            58 => TestArity,
            59 => SelectVal,
            60 => SelectTupleArity,
            61 => Jump,
            62 => Catch,
            63 => CatchEnd,
            64 => Move,
            65 => GetList,
            66 => GetTupleElement,
            67 => SetTupleElement,
            68 => PutString,
            69 => PutList,
            70 => PutTuple,
            71 => Put,
            72 => Badmatch,
            73 => IfEnd,
            74 => CaseEnd,
            75 => CallFun,
            76 => MakeFun,
            77 => IsFunction,
            78 => CallExtOnly,
            79 => BsStartMatch,
            80 => BsGetInteger,
            81 => BsGetFloat,
            82 => BsGetBinary,
            83 => BsSkipBits,
            84 => BsTestTail,
            85 => BsSave,
            86 => BsRestore,
            87 => BsInit,
            88 => BsFinal,
            89 => BsPutInteger,
            90 => BsPutBinary,
            91 => BsPutFloat,
            92 => BsPutString,
            93 => BsNeedBuf,
            94 => Fclearerror,
            95 => Fcheckerror,
            96 => Fmove,
            97 => Fconv,
            98 => Fadd,
            99 => Fsub,
            100 => Fmul,
            101 => Fdiv,
            102 => Fnegate,
            103 => MakeFun2,
            104 => Try,
            105 => TryEnd,
            106 => TryCase,
            107 => TryCaseEnd,
            108 => Raise,
            109 => BsInit2,
            110 => BsBitsToBytes,
            111 => BsAdd,
            112 => Apply,
            113 => ApplyLast,
            114 => IsBoolean,
            115 => IsFunction2,
            116 => BsStartMatch2,
            117 => BsGetInteger2,
            118 => BsGetFloat2,
            119 => BsGetBinary2,
            120 => BsSkipBits2,
            121 => BsTestTail2,
            122 => BsSave2,
            123 => BsRestore2,
            124 => GcBif1,
            125 => GcBif2,
            126 => BsFinal2,
            127 => BsBitsToBytes2,
            128 => PutLiteral,
            129 => IsBitstr,
            130 => BsContextToBinary,
            131 => BsTestUnit,
            132 => BsMatchString,
            133 => BsInitWritable,
            134 => BsAppend,
            135 => BsPrivateAppend,
            136 => Trim,
            137 => BsInitBits,
            138 => BsGetUtf8,
            139 => BsSkipUtf8,
            140 => BsGetUtf16,
            141 => BsSkipUtf16,
            142 => BsGetUtf32,
            143 => BsSkipUtf32,
            144 => BsUtf8Size,
            145 => BsPutUtf8,
            146 => BsUtf16Size,
            147 => BsPutUtf16,
            148 => BsPutUtf32,
            149 => OnLoad,
            150 => RecvMark,
            151 => RecvSet,
            152 => GcBif3,
            153 => Line,
            154 => PutMapAssoc,
            155 => PutMapExact,
            156 => IsMap,
            157 => HasMapFields,
            158 => GetMapElements,
            159 => IsTaggedTuple,
            160 => BuildStacktrace,
            161 => RawRaise,
            162 => GetHd,
            163 => GetTl,
            164 => PutTuple2,
            165 => BsGetTail,
            166 => BsStartMatch3,
            167 => BsGetPosition,
            168 => BsSetPosition,
            169 => Swap,
            170 => BsStartMatch4,
            171 => MakeFun3,
            172 => InitYregs,
            173 => RecvMarkerBind,
            174 => RecvMarkerClear,
            175 => RecvMarkerReserve,
            176 => RecvMarkerUse,
            177 => BsCreateBin,
            178 => CallFun2,
            179 => NifStart,
            180 => Badrecord,
            181 => UpdateRecord,
            182 => BsMatch,
            183 => ExecutableLine,
            _ => return Err(format!("Invalid op code: {value}")),
        };

        Ok(op_code)
    }
}
